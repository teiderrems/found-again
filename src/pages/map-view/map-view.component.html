 <div class="w-full h-full flex flex-col">
      <!-- Header -->
      <div class="bg-white border-b border-gray-200 shadow-sm p-4 sm:p-6">
        <div class="max-w-7xl mx-auto flex items-center justify-between">
          <div>
            <h1 class="text-2xl sm:text-3xl font-bold text-gray-900">Carte des Objets</h1>
            <p class="text-gray-600 text-sm mt-1">{{ markers.length }} objet(s) sur la carte</p>
          </div>
          <button (click)="goBack()"
            class="flex items-center space-x-2 px-4 py-2 rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd" />
            </svg>
            <span class="text-gray-700 font-medium">Retour</span>
          </button>
        </div>
      </div>

      <!-- Map Container -->
      <div class="flex-1 w-full flex">
        <!-- Map -->
        <div class="flex-1 w-full">
          <app-map
            [latitude]="centerLat"
            [longitude]="centerLng"
            [zoomLevel]="zoomLevel"
            [markers]="markers"
            [defaultRouteOrigin]="defaultRouteOrigin"
            [defaultRouteDestination]="defaultRouteDestination"
            [showDefaultRoute]="showDefaultRoute"
          ></app-map>
        </div>

        <!-- Markers List (Desktop only) -->
        <div *ngIf="markers.length > 0 && !showDefaultRoute" class="hidden lg:block w-80 bg-white border-l border-gray-200 overflow-y-auto shadow-lg">
          <div class="sticky top-0 bg-white border-b border-gray-200 p-4">
            <h3 class="font-semibold text-gray-900">{{ markers.length }} Objet(s)</h3>
            <p class="text-xs text-gray-500 mt-1">Cliquez pour voir les détails</p>
          </div>
          <div class="divide-y">
            <button *ngFor="let marker of markers; let i = index"
              (click)="selectMarker(i)"
              [class.bg-blue-50]="isMarkerSelected(i)"
              class="w-full text-left p-4 hover:bg-gray-50 transition-colors border-l-4 border-transparent hover:border-gray-300"
              [style.border-left-color]="getMarkerColor(i)">
              <div class="flex items-start space-x-3">
                <div [class]="'shrink-0 w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold text-white ' + getMarkerBgColor(i)">
                  {{ getMarkerLabel(i) }}
                </div>
                <div class="flex-1 min-w-0">
                  <p class="font-medium text-gray-900 truncate">{{ marker.title }}</p>
                  <p class="text-xs text-gray-500 truncate">{{ marker.description }}</p>
                  <p class="text-xs text-gray-400 mt-1">{{ marker.position.lat.toFixed(2) }}, {{ marker.position.lng.toFixed(2) }}</p>
                </div>
              </div>
            </button>
          </div>
        </div>
      </div>

      <!-- Object Info Sidebar (Mobile-friendly) -->
      <div *ngIf="selectedMarker" 
        [@slideInUp]
        class="absolute bottom-0 left-0 right-0 sm:bottom-6 sm:left-6 sm:right-auto sm:max-w-sm bg-white rounded-t-2xl sm:rounded-2xl shadow-2xl border border-gray-200 max-h-80 overflow-y-auto z-40">
        <div class="sticky top-0 bg-white border-b border-gray-200 p-4 flex items-center justify-between rounded-t-2xl sm:rounded-t-2xl">
          <h3 class="font-semibold text-gray-900">Détails de l'Objet</h3>
          <button (click)="selectedMarker = null" class="text-gray-500 hover:text-gray-700">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
            </svg>
          </button>
        </div>
        <div class="p-4 space-y-4">
          <!-- Type Badge -->
          <div>
            <span [class]="'inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ' + (selectedMarker.declarationType === DeclarationType.FOUND ? 'bg-blue-100 text-blue-700' : 'bg-orange-100 text-orange-700')">
              {{ selectedMarker.declarationType === DeclarationType.FOUND ? 'Trouvé' : 'Perdu' }}
            </span>
          </div>

          <!-- Title -->
          <div>
            <p class="text-xs text-gray-500 font-medium uppercase">Titre</p>
            <p class="text-gray-900 font-semibold mt-1">{{ selectedMarker.title }}</p>
          </div>

          <!-- Category -->
          <div>
            <p class="text-xs text-gray-500 font-medium uppercase">Catégorie</p>
            <p class="text-gray-700 mt-1">{{ selectedMarker.category }}</p>
          </div>

          <!-- Description -->
          <div>
            <p class="text-xs text-gray-500 font-medium uppercase">Description</p>
            <p class="text-gray-700 text-sm mt-1 line-clamp-3">{{ selectedMarker.description }}</p>
          </div>

          <!-- Location -->
          <div>
            <p class="text-xs text-gray-500 font-medium uppercase">Localisation</p>
            <p class="text-gray-700 text-sm mt-1">{{ selectedMarker.location }}</p>
          </div>

          <!-- Date -->
          <div>
            <p class="text-xs text-gray-500 font-medium uppercase">Date</p>
            <p class="text-gray-700 text-sm mt-1">{{ selectedMarker.date | date: 'dd/MM/yyyy' }}</p>
          </div>

          <!-- Images -->
          <div *ngIf="selectedMarker.images && selectedMarker.images.length > 0">
            <p class="text-xs text-gray-500 font-medium uppercase mb-2">Images ({{ selectedMarker.images.length }})</p>
            <div class="grid grid-cols-2 gap-2">
              <img *ngFor="let img of selectedMarker.images.slice(0, 4)" 
                [src]="img.downloadURL" 
                [alt]="selectedMarker.title"
                class="w-full h-24 object-cover rounded-lg">
            </div>
          </div>

          <!-- Action Button -->
          <button (click)="viewDetails(selectedMarker.declarationId)"
            class="w-full bg-linear-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-semibold py-2.5 rounded-lg transition-all duration-200">
            Voir Détails
          </button>
        </div>
      </div>
    </div>